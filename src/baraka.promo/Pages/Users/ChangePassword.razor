@page "/userchangepassword"
@using baraka.promo.Pages.Promos;

@inject UserAddModel newUser
@inject DialogService _dialogService
@inject NotificationService _notificationService

@if (newUser != null && newUser.Model != null)
{
    <EditForm Model="@newUser.Model" OnValidSubmit="(e=>newUser.Save())">
        <div class="row">
            <div class="col-12">
                <div class="form-group d-flex justify-content-center">
                    <label class="font-weight-bold">Имя пользователя - @newUser.Model.UserName</label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="form-group">
                    <label>Пароль"</label>
                    <RadzenPassword @bind-Value=@newUser.Model.Password class="col-12" />
                    <ValidationMessage For="@(()=>newUser.Model.Password)"></ValidationMessage>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="form-group">
                    <label>Подтвердите пароль</label>
                    <RadzenPassword @bind-Value=@newUser.Model.ConfirmPassword class="col-12" />
                    <ValidationMessage For="@(()=>newUser.Model.ConfirmPassword)"></ValidationMessage>
                </div>
            </div>
        </div>

        <div class="row position-absolute" style="bottom:1.25rem;right:1.25rem">
            <div class="col-12">
                <RadzenButton ButtonType="ButtonType.Submit" Click="@newUser.Save" Text="Сохранять" Style="width: 150px" />
                <RadzenButton Click="@newUser.Close" ButtonStyle="ButtonStyle.Secondary" Text="Закрывать" Style="width: 150px" />
            </div>
        </div>
        <ObjectGraphDataAnnotationsValidator />
    </EditForm>
}

@code {
    [Parameter]
    public string Model { get; set; }

    protected override void OnInitialized()
    {
        newUser.StateHasChanged = () => { StateHasChanged(); };

        newUser.OnInitializedAsync(Model);
    }
}
